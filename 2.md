![Docker logo](img/docker_logo.png)

## Docker for Developers - Introduction

#### [CubanTech Meetups](http://www.meetup.com/CubanTech), 19 October 2019
#### [Docker Cuba Meetups](http://www.meetup.com/Docker-Cuba), 19 October 2019

###### [Marcos Maceo](https://github.com/stdevMac) / [@marcosmaceo](https://t.me/marcosmaceo)
###### [Adrian Paez](https://github.com/stdevAdrianPaez) / [@Wic97](https://t.me/Wic97)
###### [The CubanTech Group](http://cuban.tech) / [@TheCubanTech](http://twitter.com/TheCubanTech)
________________________

###### Get them: [online presentation](http://cubantech.github.io/docker-presentation/) / [source code](http://github.com/cubantech/docker-presentation) / [docker image](http://hub.docker.com/r/tplcom/docker-presentation/)

###### Under [Attribution 4.0 International](http://creativecommons.org/licenses/by/4.0/) license.

---

### Acknowledgements

#### Based on slides for presentation in [Python Meetup Thessaloniki](http://www.meetup.com/PyThess/), 15 April 2016

###### [TheodorosPloumis.com](http://www.theodorosploumis.com/en) / [@theoploumis](http://twitter.com/theoploumis)

---

### Remembering

---

#### Few presentations away..

---

### Dockerfile in deep

#### Anatomy of a dockerfile

```
FROM python-alpine 

LABEL "maintainer"="some@example.com"
LABEL "rating"="Five Stars" "class"="First Class"

USER root

ENV APP /data/app

# Application Code
WORKDIR $APP 
COPY ./some.txt some.txt
RUN ls

CMD ["python3","-m","http.server"]
```

---

#### Base images

```
FROM python-alpine 
```

---

```
LABEL "maintainer"="some@example.com"
LABEL "rating"="Five Stars" "class"="First Class"
```

#### NOTE

```
MAINTAINER is a deprecated field in the Dockerfile specification. It was designed to
provided contact information for the Dockerfile’s author, but Docker now recommends
simply using a label for this purpose.
```

---

```
USER root

ENV APP /data/app
```

#### CAUTION

```
Even though containers provide some isolation from the underlying operating system, they
still run on the host kernel. Due to potential security risks, production containers should
almost always be run under the context of a nonprivileged user.
```

---

#### Code specific stuffs

```
# Application Code
WORKDIR $APP 
COPY ./some.txt some.txt
RUN ls
```

---

### Command for the image

```
CMD ["python3","-m","http.server"]
```

---

### ADD vs COPY

```
Copy just copy
COPY src dest
```

```
Add download from urls and decompress .tar files
ADD src dest
```

---


### Entrypoint

`ENTRYPOINT` has two forms:
```
ENTRYPOINT ["executable", "param1", "param2"] (exec form, preferred)
ENTRYPOINT command param1 param2 (shell form)
```

---

### ENTRYPOINT vs CMD

#### ONLY ENTRYPOINT

```
FROM python-alpine
ENTRYPOINT ["ping", "localhost"]
```

#### OVERRYDING

```
docker run --entrypoint=ping test-some google.com
```

---

#### ONLY CMD

```
FROM ubuntu:trusty
CMD ["/bin/ping","localhost"]
```

---

#### ENTRYPOINT and CMD

```
FROM ubuntu:trusty
ENTRYPOINT ["/bin/ping","-c","3"]
CMD ["localhost"]
```

---

### Building the image

```
docker build -t example/docker­example:latest .
```

---

### MultiStage builds

```go
package main

import (
	"fmt"
	"log"
	"net/http"
)

const (
	serverAddress = ":3030"
)

func handler(w http.ResponseWriter, r *http.Request) {
	fmt.Println("welcome");
	fmt.Fprintf(w, "Hello welcome %s!", r.URL.Path[1:])
}

func main() {
	http.HandleFunc("/", handler)

	log.Println("Listening on port ", serverAddress)
	log.Fatal(http.ListenAndServe(serverAddress, nil))
}
```

---

### The dockerfile

```
FROM golang:1.12.6-alpine3.10 AS builder
ADD . /app/backend
WORKDIR /app/backend
RUN CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -a -o /main .

# final stage
FROM alpine:latest
COPY --from=builder /main ./
RUN chmod +x ./main
ENTRYPOINT ["./main"]
EXPOSE 3030
```

---

### Docker-compose

---

#### Few presentations away..

---

### Docker Swarm

---

#### Few presentations away..

---